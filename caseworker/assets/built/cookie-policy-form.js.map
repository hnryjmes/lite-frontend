{"mappings":"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","sources":["node_modules/@swc/helpers/src/_create_class.js","node_modules/@swc/helpers/src/_iterable_to_array.js","node_modules/@swc/helpers/src/_sliced_to_array.js","node_modules/@swc/helpers/src/_array_with_holes.js","node_modules/@swc/helpers/src/_non_iterable_rest.js","core/assets/javascripts/cookies/consts.js","core/assets/javascripts/cookies/utils.js","core/assets/javascripts/cookies/preferences.js","node_modules/@swc/helpers/src/_class_call_check.js","caseworker/assets/javascripts/cookie-policy-form.js"],"sourcesContent":["function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n","export default function _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n","import arrayWithHoles from './_array_with_holes';\nimport iterableToArrayLimit from './_iterable_to_array';\nimport nonIterableRest from './_non_iterable_rest';\n\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n","const POLICY_COOKIE_NAME = \"cookies_policy\";\nconst POLICY_COOKIE_DURATION_DAYS = 365;\n\nconst PREFERENCES_COOKIE_NAME = \"cookie_preferences_set\";\nconst PREFERENCES_COOKIE_DURATION_DAYS = 365;\n\nexport {\n    POLICY_COOKIE_NAME,\n    POLICY_COOKIE_DURATION_DAYS,\n    PREFERENCES_COOKIE_NAME,\n    PREFERENCES_COOKIE_DURATION_DAYS,\n};\n","import {\n    PREFERENCES_COOKIE_NAME,\n    PREFERENCES_COOKIE_DURATION_DAYS,\n    POLICY_COOKIE_NAME,\n    POLICY_COOKIE_DURATION_DAYS,\n} from \"./consts\";\n\nconst getCookie = (name) => {\n    const nameEQ = name + \"=\";\n    const cookies = document.cookie.split(\";\");\n    for (let i = 0, len = cookies.length; i < len; i++) {\n        let cookie = cookies[i];\n        while (cookie.charAt(0) === \" \") {\n            cookie = cookie.substring(1, cookie.length);\n        }\n        if (cookie.indexOf(nameEQ) === 0) {\n            return decodeURIComponent(cookie.substring(nameEQ.length));\n        }\n    }\n    return null;\n};\n\nconst setCookie = (name, value, options) => {\n    if (typeof options === \"undefined\") {\n        options = {};\n    }\n    let cookieString = name + \"=\" + value + \"; path=/\";\n    if (options.days) {\n        let date = new Date();\n        date.setTime(date.getTime() + options.days * 24 * 60 * 60 * 1000);\n        cookieString = cookieString + \"; expires=\" + date.toGMTString();\n    }\n    if (document.location.protocol === \"https:\") {\n        cookieString = cookieString + \"; Secure\";\n    }\n    document.cookie = cookieString;\n};\n\nconst getDefaultPolicy = () => ({\n    essential: true,\n    settings: false,\n    usage: false,\n    campaigns: false,\n});\n\nconst setPoliciesCookie = (settings, usage, campaigns) => {\n    const policy = getDefaultPolicy();\n    policy.settings = settings || false;\n    policy.usage = usage || false;\n    policy.campaigns = campaigns || false;\n\n    const json = JSON.stringify(policy);\n    setCookie(POLICY_COOKIE_NAME, json, { days: POLICY_COOKIE_DURATION_DAYS });\n\n    return policy;\n};\n\nconst setPreferencesCookie = () => {\n    setCookie(PREFERENCES_COOKIE_NAME, \"true\", {\n        days: PREFERENCES_COOKIE_DURATION_DAYS,\n    });\n};\n\nexport {\n    getCookie,\n    setCookie,\n    getDefaultPolicy,\n    setPoliciesCookie,\n    setPreferencesCookie,\n};\n","import { POLICY_COOKIE_NAME } from \"./consts\";\nimport {\n    getCookie,\n    getDefaultPolicy,\n    setPoliciesCookie,\n    setPreferencesCookie,\n} from \"./utils\";\n\nclass CookiePreferences {\n    constructor(formSelector, confirmationSelector, radioButtons) {\n        this.formSelector = formSelector;\n        this.confirmationSelector = confirmationSelector;\n        this.radioButtons = radioButtons;\n\n        this.form = document.querySelector(this.formSelector);\n    }\n\n    boolToValue(b) {\n        return b ? \"on\" : \"off\";\n    }\n\n    valueToBool(value) {\n        return value === \"on\";\n    }\n\n    getPolicyOrDefault() {\n        const cookie = getCookie(POLICY_COOKIE_NAME);\n        const policy = getDefaultPolicy();\n\n        if (!cookie) return policy;\n\n        try {\n            const parsed = JSON.parse(cookie);\n\n            policy.campaigns = parsed.campaigns || false;\n            policy.usage = parsed.usage || false;\n            policy.settings = parsed.settings || false;\n        } catch (e) {\n            return policy;\n        }\n\n        return policy;\n    }\n\n    initFormValues() {\n        const policy = this.getPolicyOrDefault();\n\n        Object.entries(this.radioButtons).forEach(([key, inputName]) => {\n            this.form[inputName].value = this.boolToValue(policy[key]);\n        });\n    }\n\n    setPoliciesCookie() {\n        const policy = {\n            settings: false,\n            usage: false,\n            campaigns: false,\n        };\n\n        Object.entries(this.radioButtons).forEach(([key, inputName]) => {\n            policy[key] = this.valueToBool(this.form[inputName].value);\n        });\n\n        setPoliciesCookie(policy.settings, policy.usage, policy.campaigns);\n    }\n\n    displayConfirmation() {\n        const confirmationEl = document.querySelector(this.confirmationSelector);\n\n        confirmationEl.style.display = \"block\";\n    }\n\n    bindForm() {\n        this.form.addEventListener(\"submit\", (evt) => {\n            evt.preventDefault();\n\n            this.setPoliciesCookie();\n            setPreferencesCookie();\n            this.displayConfirmation();\n\n            window.scrollTo(0, 0);\n\n            return false;\n        });\n    }\n}\n\nconst initCookiePreferences = (\n    formSelector,\n    confirmationSelector,\n    radioButtons\n) => {\n    const cookiePreferences = new CookiePreferences(\n        formSelector,\n        confirmationSelector,\n        radioButtons\n    );\n\n    cookiePreferences.initFormValues();\n    cookiePreferences.bindForm();\n};\n\nexport default initCookiePreferences;\n","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","import initCookiePreferences from \"../../../core/assets/javascripts/cookies/preferences.js\";\n\ninitCookiePreferences(\n    \"#cookie-preferences-form\",\n    \".cookie-settings__confirmation\",\n    {\n        usage: \"cookies-usage\",\n    }\n);\n"],"names":["$04bf43472e4725ae$var$_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","iter","Symbol","iterator","prototype","toString","call","Array","from","arr","isArray","$673e34569eddad27$export$2e2bcd8739ae039","$bdc152bf6018edeb$export$2e2bcd8739ae039","TypeError","$9ceebec9c95761fa$export$2e2bcd8739ae039","$931f469a9cb13576$export$885d3f877b02ad5e","$ef65029f6ae99ed4$export$110700823644f4a6","name","value","options","cookieString","days","date","Date","setTime","getTime","toGMTString","document","location","protocol","cookie","$1b7d90e37d6479f4$var$CookiePreferences","formSelector","confirmationSelector","radioButtons","instance","Constructor","this","form","querySelector","protoProps","staticProps","b","nameEQ","cookies","split","len","charAt","substring","indexOf","decodeURIComponent","$ef65029f6ae99ed4$export$4be65e66cfa2648a","policy","essential","settings","usage","campaigns","parsed","JSON","parse","e","getPolicyOrDefault","entries","forEach","param","_param","inputName","_this","boolToValue","valueToBool","json","stringify","$ef65029f6ae99ed4$export$5d0c102c5d7f343d","style","display","addEventListener","evt","preventDefault","setPoliciesCookie","displayConfirmation","window","scrollTo","cookiePreferences","initFormValues","bindForm","$1b7d90e37d6479f4$export$2e2bcd8739ae039"],"version":3,"file":"cookie-policy-form.js.map"}